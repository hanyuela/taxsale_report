<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Zono admin is super flexible, powerful, clean &amp; modern responsive bootstrap 5 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, Zono admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="pixelstrap">
    <link rel="icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">
    <link rel="shortcut icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">
    <title>Zono - Premium Admin Template</title>
    <!-- Google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@200;300;400;600;700;800;900&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900&amp;display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.css' %}">
    <!-- ico-font-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/icofont.css' %}">
    <!-- Themify icon-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/themify.css' %}">
    <!-- Flag icon-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/flag-icon.css' %}">
    <!-- Feather icon-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/feather-icon.css' %}">
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/animate.css' %}">
    <!-- Plugins css Ends-->
    <!-- Bootstrap css-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/vendors/bootstrap.css' %}">
    <!-- App css-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <link id="color" rel="stylesheet" href="{% static 'css/color-1.css' %}" media="screen">
    <!-- Responsive css-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/responsive.css' %}">
  </head>
  <style>
    .wizard-4 ul.custom-scrollbar li {
    display: flex;
    align-items: center;
    justify-content: start;
    margin-bottom: 10px; /* 设置适当的间距 */
    }

    li a h4 {
    margin-top: 10px; /* 调整这个值以控制下移的距离 */   
    }

    li a h5 {
      margin-top: 20px; /* 调整这个值以控制标题下移的距离 */
    }
  </style>
  <body>
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-danger">{{ message }}</div>
        {% endfor %}
    {% endif %}
    <!-- login page start-->
    <div class="container-fluid">
      <div class="row">
          <div class="col-12 p-0">
              <div>
                  <div class="theme-form">
                      <div class="wizard-4" id="wizard">
                          <ul class="custom-scrollbar">
                              <li>
                                  <a class="logo text-start" href="{% url 'index' %}">
                                      <img class="img-fluid for-light" src="{% static 'images/logo/logo.png' %}" alt="loginpage">
                                      <img class="img-fluid for-dark" src="{% static 'images/logo/logo_dark.png' %}" alt="loginpage">
                                  </a>
                              </li>
                              <li>
                                  <a href="#step-1">
                                      <h4>1</h4>
                                      <h5>Register</h5>
                                  </a>
                              </li>
                              <li>
                                  <a href="#step-2">
                                      <h4>2</h4>
                                      <h5>Personal</h5>
                                  </a>
                              </li>
                              <li>
                                  <a href="#step-3">
                                      <h4>3</h4>
                                      <h5>Preferences</h5>
                                  </a>
                              </li>
                              <li>
                                  <a href="#step-4">
                                      <h4>4</h4>
                                      <h5>Done <i class="fa fa-thumbs-o-up"></i></h5>
                                  </a>
                              </li>
                              <li>
                            </li>
                          </ul>

                          <div id="step-1">
                            <div class="wizard-title">
                                <h2>Sign Up to Account</h2>
                                <h5 class="text-muted mb-4">Enter your email & password to sign up</h5>
                            </div>
                            <div class="login-main">
                                <div class="theme-form">
                                    <form id="form-step-1">
                                        <div class="form-group mb-3 m-t-15">
                                            <label for="email">Email Address</label>
                                            <input class="form-control" id="email" type="email" name="email" placeholder="name@example.com">
                                            <small id="emailError" class="text-danger" style="display: none;">This email is already registered.</small>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="password">Password</label>
                                            <input class="form-control" id="password" type="password" name="password" placeholder="Password">
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="confirm_password">Confirm Password</label>
                                            <input class="form-control" id="confirm_password" type="password" name="confirm_password" placeholder="Confirm Password">
                                            <small id="passwordError" class="text-danger" style="display: none;">Passwords do not match!</small>
                                        </div>
                                        <div class="form-group mb-3" style="text-align: center;">
                                            <a href="{% url 'request_password_reset' %}" class="text-primary">Forgot Password?</a><br>
                                            <a href="{% url 'login' %}" class="text-primary">Already have an account? Login</a>
                                        </div>
                                        <!-- Buttons moved here -->
                                        <div class="form-group button-group" style="text-align: right;">
                                            <button type="button" id="next-step-1" class="btn btn-primary">Next</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        

                          <!-- Step 2: Personal Information -->
                          <div id="step-2">
                            <div class="wizard-title">
                                <h2>Personal Information</h2>
                                <h5 class="text-muted mb-4">Enter your name and contact information</h5>
                            </div>
                            <div class="login-main">
                                <div class="theme-form">
                                    <form id="form-step-2">
                                        <div class="form-group mb-3">
                                            <label for="first_name">First Name</label>
                                            <input class="form-control" id="first_name" type="text" name="first_name" placeholder="John" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="last_name">Last Name</label>
                                            <input class="form-control" id="last_name" type="text" name="last_name" placeholder="Doe" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="phone_number">Phone Number</label>
                                            <input class="form-control" id="phone_number" type="text" name="phone_number" placeholder="123-456-7890" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="investment_amount">How much are you planning to invest in tax sales?</label>
                                            <input class="form-control" id="investment_amount" type="number" name="investment_amount" placeholder="Investment amount" required>
                                        </div>
                                        <!-- Buttons moved here -->
                                        <div class="form-group button-group" style="display: flex; justify-content: space-between;">
                                            <button type="button" id="previous-step-2" class="btn btn-secondary">Previous</button>
                                            <button type="button" id="next-step-2" class="btn btn-primary">Next</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                          </div>
                        

                          <!-- Step 3: User Preferences -->
                          <div id="step-3">
                              <div class="wizard-title">
                                  <h2>User Preferences</h2>
                                  <h5 class="text-muted mb-4">Select your preferences for investment</h5>
                              </div>
                              <div class="login-main">
                                  <div class="theme-form">
                                      <form id="form-step-3">
                                          <div class="form-group mb-3">
                                              <label for="investment_purpose">What is your main purpose for investing in tax sales?</label><br>
                                              <input type="radio" id="earn_interest" name="investment_purpose" value="Earn Interest">
                                              <label for="earn_interest">Earn Interest</label><br>
                                              <input type="radio" id="foreclose_property" name="investment_purpose" value="Foreclose on properties">
                                              <label for="foreclose_property">Foreclose on properties</label><br>
                                          </div>
                                          <div class="form-group mb-3">
                                              <label for="property_type">What type of property are you interested in?</label>
                                              <div class="interest-container" style="display: flex; flex-direction: column; gap: 10px;">
                                                <label for="single_family">
                                                    <input type="checkbox" id="single_family_residential" name="property_type" value="single_family_residential" style="margin-right: 5px;">
                                                    Single-Family Residential
                                                </label>
                                                <label for="multi_family">
                                                    <input type="checkbox" id="multi_family_residential" name="property_type" value="multi_family_residential" style="margin-right: 5px;">
                                                    Multi-Family Residential
                                                </label>
                                                <label for="other_residentials">
                                                    <input type="checkbox" id="other_residentials" name="property_type" value="other_residential" style="margin-right: 5px;">
                                                    Other Residential
                                                </label>
                                                <label for="commercial">
                                                    <input type="checkbox" id="commercial" name="property_type" value="commercial" style="margin-right: 5px;">
                                                    Commercial
                                                </label>
                                                <label for="vacant_land">
                                                    <input type="checkbox" id="vacant_land" name="property_type" value="vacant_land" style="margin-right: 5px;">
                                                    Vacant Land
                                                </label>
                                                <label for="agricultural">
                                                    <input type="checkbox" id="agricultural" name="property_type" value="agricultural" style="margin-right: 5px;">
                                                    Agricultural
                                                </label>
                                                <label for="industrial">
                                                    <input type="checkbox" id="industrial" name="property_type" value="industrial" style="margin-right: 5px;">
                                                    Industrial
                                                </label>
                                                <label for="miscellaneous">
                                                    <input type="checkbox" id="miscellaneous" name="property_type" value="miscellaneous" style="margin-right: 5px;">
                                                    Miscellaneous
                                                </label>
                                                <!-- Buttons moved here -->
                                                <div class="form-group button-group" style="display: flex; justify-content: space-between;">
                                                    <button type="button" id="previous-step-3" class="btn btn-secondary">Previous</button>
                                                    <button type="button" id="next-step-3" class="btn btn-primary">Next</button>
                                                </div>
                                            </div>                                            
                                          </div>
                                      </form>
                                  </div>
                              </div>
                          </div>

                          <!-- Step 4: Done -->
                          <div id="step-4">
                              <div class="wizard-title">
                                  <h2>Address Information</h2>
                                  <h5 class="text-muted mb-4">Enter your country, state, and city</h5>
                              </div>
                              <div class="login-main">
                                  <div class="theme-form">
                                      <form id="final-form" action="{% url 'sign-up-wizard' %}" method="POST">
                                         {% csrf_token %}
                                          <div class="form-group mb-3">
                                              <label for="tax_lien_interest">Are you interested in:</label>
                                              <div class="interest-container" style="display: flex; justify-content: space-between; margin-top: 10px;">
                                                  <div class="interest-group" style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px;">
                                                    <label for="tax_lien" style="display: flex; align-items: center;">
                                                        <input type="checkbox" id="tax_lien" name="auction_type" value="tax lien" style="margin-right: 5px;">
                                                        Tax Lien
                                                        </label>
                                                        <label for="tax_deed" style="display: flex; align-items: center;">
                                                            <input type="checkbox" id="tax_deed" name="auction_type" value="tax deed" style="margin-right: 5px;">
                                                            Tax Deed
                                                        </label>
                                                    </div>
                                                    <!-- 右边复选框组 -->
                                                    <div class="interest-group" style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px;">
                                                        <label for="online_auction" style="display: flex; align-items: center;">
                                                            <input type="checkbox" id="online_auction" name="is_online" value="online" style="margin-right: 5px;">
                                                            Online Auction
                                                        </label>
                                                        <label for="in_person" style="display: flex; align-items: center;">
                                                            <input type="checkbox" id="in_person" name="is_online" value="in-person" style="margin-right: 5px;">
                                                            In Person
                                                        </label>
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="col-12">
                                              <div class="card w-100">
                                                  <div class="card-header pb-0">
                                                      <h4>Select States</h4>
                                                      <p class="f-m-light mt-1">
                                                          Use the multi-select dropdown to select one or more states.
                                                      </p>
                                                  </div>
                                                  <div class="card-body">
                                                    <select class="form-control mt-1" name="states" id="state" multiple>
                                                        {% for state in states %}
                                                            <option value="{{ state.abbreviation }}">{{ state.state }}</option>
                                                        {% endfor %}
                                                    </select>                                                                                                     
                                                  </div>
                                                  <!-- Fields -->
                                                    <div class="form-group button-group" style="display: flex; justify-content: space-between;">
                                                        <button type="button" id="previous-step-4" class="btn btn-secondary">Previous</button>
                                                        <button type="button" id="finish-step" class="btn btn-success">Finish</button>
                                                    </div>
                                              </div>
                                          </div>
                                         <!-- <button type="submit" class="btn btn-primary w-100">Complete Registration</button> -->
                                      </form>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
    </div>
    <!-- latest jquery-->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <!-- Bootstrap js-->
    <script src="{% static 'js/bootstrap/bootstrap.bundle.min.js' %}"></script>
    <!-- feather icon js-->
    <script src="{% static 'js/icons/feather-icon/feather.min.js' %}"></script>
    <script src="{% static 'js/icons/feather-icon/feather-icon.js' %}"></script>
    <!-- scrollbar js-->
    <!-- Sidebar jquery-->
    <script src="{% static 'js/config.js' %}"></script>
    <!-- Plugins JS start-->
    <script src="{% static 'js/form-wizard/form-wizard-five.js' %}"></script>
    <script src="{% static 'js/tooltip-init.js' %}"></script>
    <!-- Plugins JS Ends-->
    <!-- Theme js-->
    <script src="{% static 'js/script.js' %}"></script>
    <script src="{% static 'js/theme-customizer/customizer.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <!-- Plugin used-->
    <script>
      $(document).ready(function() {
          $('#state').select2({
              placeholder: "Select a State",
              allowClear: true,
              closeOnSelect: false // 防止选择后自动关闭
          });
      });
    </script>
    <script>
      document.getElementById('final-form').addEventListener('submit', function (event) {
      // 获取步骤1的表单数据
      const step1Fields = document.querySelectorAll('#form-step-1 input');
      step1Fields.forEach(field => {
          const hiddenInput = document.createElement('input');
          hiddenInput.type = 'hidden';
          hiddenInput.name = field.name;
          hiddenInput.value = field.value;
          document.getElementById('final-form').appendChild(hiddenInput);
      });

      // 获取步骤2的表单数据
      const step2Fields = document.querySelectorAll('#form-step-2 input');
      step2Fields.forEach(field => {
          if (field.value) { // 仅拷贝非空字段
              const hiddenInput = document.createElement('input');
              hiddenInput.type = 'hidden';
              hiddenInput.name = field.name;
              hiddenInput.value = field.value;
              document.getElementById('final-form').appendChild(hiddenInput);
          }
      });

      // 获取步骤3的表单数据
      const step3Fields = document.querySelectorAll('#form-step-3 input:checked');
      step3Fields.forEach(field => {
          const hiddenInput = document.createElement('input');
          hiddenInput.type = 'hidden';
          hiddenInput.name = field.name;
          hiddenInput.value = field.value;
          document.getElementById('final-form').appendChild(hiddenInput);
      });

      // 表单提交前会动态添加字段
        });

        document.getElementById('email').addEventListener('blur', function () {
            const email = this.value.trim();

            // 验证是否为空
            if (!email) {
                document.getElementById('emailError').innerText = 'Email is required.';
                document.getElementById('emailError').style.display = 'block';
                return;
            }

            // 发起 Ajax 请求检查邮箱
            fetch('/check-email/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}', // 确保 CSRF token 正确设置
                },
                body: JSON.stringify({ email: email }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    document.getElementById('emailError').innerText = 'This email is already registered.';
                    document.getElementById('emailError').style.display = 'block';
                } else {
                    document.getElementById('emailError').style.display = 'none';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('emailError').innerText = 'Error checking email. Please try again later.';
                document.getElementById('emailError').style.display = 'block';
            });
        });

      </script>
      <script>// 获取密码输入框
        const passwordField = document.getElementById('password');
        const confirmPasswordField = document.getElementById('confirm_password');
        const passwordError = document.getElementById('passwordError');
        
        // 检查两次密码是否一致
        function checkPasswordsMatch() {
            const password = passwordField.value.trim();
            const confirmPassword = confirmPasswordField.value.trim();
        
            if (password && confirmPassword && password !== confirmPassword) {
                passwordError.innerText = 'Passwords do not match!';
                passwordError.style.display = 'block';
            } else {
                passwordError.style.display = 'none';
            }
        }
        
        // 绑定事件监听
        passwordField.addEventListener('input', checkPasswordsMatch);
        confirmPasswordField.addEventListener('input', checkPasswordsMatch);
        </script>
    </div>
  </body>
</html>